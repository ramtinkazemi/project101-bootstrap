AWSTemplateFormatVersion: '2010-09-09'
Description: Bootstrap template for bootstrap App

Resources:

  TerraformStateLockTable:
    Type: AWS::DynamoDB::Table
    Properties:
      TableName: !Sub "{{stack}}-{{component}}-{{env}}-terraform-lock-${AWS::AccountId}-${AWS::Region}"
      AttributeDefinitions:
        - AttributeName: LockID
          AttributeType: S
      KeySchema:
        - AttributeName: LockID
          KeyType: HASH
      ProvisionedThroughput:
        ReadCapacityUnits: 5
        WriteCapacityUnits: 5
      SSESpecification:
        SSEEnabled: true

  TerraformStateLockTableNameParameter:
    Type: 'AWS::SSM::Parameter'
    Properties:
      Name: '/facts/v1/{{stack}}-{{component}}-{{env}}/terraform-state-lock-table-name'
      Type: String
      Value: !Ref TerraformStateLockTable

Outputs:
  TerraformStateLockTableName:
    Description: "DynamoDB Table for Terraform State Lock"
    Value: !Ref TerraformStateLockTable
